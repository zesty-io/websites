<html>
    <head>
        <title>Zesty.io Rest API Fetch Wrapper</title>
        <script src="zestyio-rest-fetch-wrapper.js"></script>
        <script>

            var ZestyAPI = {}

            // cookie things
            function setCookie(cname, cvalue, exdays) {
                var d = new Date();
                d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
                var expires = "expires="+d.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }

            function getCookie(cname) {
                var name = cname + "=";
                var ca = document.cookie.split(';');
                for(var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                    }
                }
                return "";
            }

            function checkCookie() {
                var user = getCookie("username");
                if (user != "") {
                    alert("Welcome again " + user);
                } else {
                    user = prompt("Please enter your name:", "");
                    if (user != "" && user != null) {
                    setCookie("username", user, 365);
                    }
                }
            }

            function updateToken(name, value){
                setCookie(name,value)
                window.location.reload()
            }

            if(getCookie('APP_SID') != ''){
                alert('Starting API')
                ZestyAPI = new ZestyioRestFetchWrapper('8-82f8f3fff6-4zq0d0',getCookie('APP_SID'))
                console.log(ZestyAPI)

                console.log(ZestyAPI.getModels());
            }
        </script>
        <style>
            body,html {
                font-family: Verdana, Geneva, Tahoma, sans-serif;
            }
        </style>
    </head>
    <body>
        <div style="padding: 5px 10px; border-radius: 5px; background: lightgrey; display: flex;">
            <div style="flex: 5">
                <h3>Start testing by setting up an auth cookie!</h3>
               
                <label>Enter your Zesty.io auth token (APP_SID):</label>
                <input type="text" value="" onChange="updateToken('APP_SID',this.value)">
                <p> You will find this by logging into accounts.zesty.io, then look at browser cookies under APP_SID.</p>
                
            </div>
            <div style="flex: 1; padding: 20px;">
                <img src="https://brand.zesty.io/zesty-io-logo.png" width="100%">
            </div>

        </div>



    </body>
</html>